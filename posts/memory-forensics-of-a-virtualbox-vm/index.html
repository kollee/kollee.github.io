<!doctype html><html xmlns=http://www.w3.org/1999/xhtml xml:lang=en-us lang=en-us><head><link href=https://gmpg.org/xfn/11 rel=profile><meta charset=utf-8><meta name=generator content="Hugo 0.101.0"><meta name=viewport content="width=device-width,initial-scale=1"><title>Memory Forensics of a Virtualbox VM &#183; TILT</title><meta name=description content><link type=text/css rel=stylesheet href=https://kollee.github.io/css/print.css media=print><link type=text/css rel=stylesheet href=https://kollee.github.io/css/poole.css><link type=text/css rel=stylesheet href=https://kollee.github.io/css/syntax.css><link type=text/css rel=stylesheet href=https://kollee.github.io/css/hyde.css><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Abril+Fatface|PT+Sans:400,400i,700"><link rel=apple-touch-icon-precomposed sizes=144x144 href=/apple-touch-icon-144-precomposed.png><link rel="shortcut icon" href=/favicon.png></head><body><aside class=sidebar><div class="container sidebar-sticky"><div class=sidebar-about><a href=https://kollee.github.io/><h1>TILT</h1></a><p class=lead>Things I Learned Today - Mostly about Information Security, Malware Analysis, Digital Forensics & Incident Response</p></div><nav><ul class=sidebar-nav><li><a href=https://kollee.github.io/>Home</a></li></ul></nav><p>&copy; 2022. All rights reserved.</p></div></aside><main class="content container"><div class=post><h1>Memory Forensics of a Virtualbox VM</h1><time datetime=2018-06-23T09:33:03+0200 class=post-date>Sat, Jun 23, 2018</time><p>I use VirtualBox to triage and analyze malware. In contrast to VMWares .vmem file, VirtualBox does not use a separate file to store the current memory. Even if you take a snapshot or pause the VM, the current memory is not saved separately but stores the complete state of the VM in a <code>.sav</code> file.</p><p>Luckily, <a href=http://wiki.yobi.be/wiki/RAM_analysis>Philippe Teuwen</a> describes another way to dump the RAM of a (running) VirtualBox VM by using the VirtualBox debugvm capabilities. This command creates a file in the <a href=https://en.wikipedia.org/wiki/Executable_and_Linkable_Format>Executable and Linking Format (ELF)</a> which you can analyzed using standard ELF tools like readelf or objdump. To ease the usage even further Philippe wrote a Volatility address space to extract the memory image from a core dump file using Volatility&rsquo;s imagecopy. Volatility includes this address space since version 2.3.</p><p>Now it is only a simple two-step process to get a memory dump of a VirtualBox VM:</p><p>Assuming your (running) VM is named <em>Win7</em> a core dump is created using</p><pre tabindex=0><code>  $ vboxmanage debugvm Win7 dumpvmcore --filename=Win7.dmp
</code></pre><p>Now you can convert this core dump to a memory dump using Volatility&rsquo;s imagecopy</p><pre tabindex=0><code>  $ python vol.py -f Win7.dmp imagecopy -O Win7.raw
</code></pre><p>Volatility can now ingest this file like any other memory dump.</p></div></main></body></html>